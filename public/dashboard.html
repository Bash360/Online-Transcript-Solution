
<!DOCTYPE html>
<html>
<head>
  <title>Decagon Transcript Solution | Dashboard</title>
  
  <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">


	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.3.1/css/all.css" integrity="sha384-mzrmE5qonljUremFsqc01SB46JvROS7bZs3IO2EmfFsd15uHvIt+Y8vEf7N7fWAU" crossorigin="anonymous">

	<link rel="stylesheet" type="text/css" href="css/style.css">
	 <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <script src="https://www.paypal.com/sdk/js?client-id=ARNHDIR-C2nC5lKYX0PHWvnv5KihpDoqJ7DRFgP0wFLyu04hgOXk15Jbjr8a3f4dE-pKicm_dyH79YNN">
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    
	<script type="text/javascript">
		if (!localStorage.getItem("studentID")) { window.location='index.html'; }
		$(document).ready(function(){
		$("#student").val(localStorage.getItem("studentID"));
		$("#orderId").val(localStorage.getItem("orderID"));
		
		
		$("#request").click(function(){
		let student=$("#student").val();
		let email=$("#email").val();
		let order=$("#orderID").val();
		let course=$("#dept option:selected").text();
		$.ajax({url:"http://localhost:3000/requestTransaction",
		method:"post",
		data:{"studentID":student,
		"email":email,
		"course":course,
		"orderID":order
		
		},
		success:function(){
		email=$("#email").val();
		  $("input[type=button]").attr("disabled", "disabled");
		  alert("Transcript has been Requested Expect Mail");
		
		}
		
		});
		});
		});
		
		</script>
	<style media="screen">
      #paypal-button-container{
        width:50px;
        height: 40px;
        margin-left: auto;
        margin-right: auto;
      }
    </style>
		
</head>
<body>

		<body>
  
				<!-- Navigation-->
				<nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
					 <button class="navbar-toggler navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
			
					<div class="collapse navbar-collapse" id="navbarResponsive">
						<ul class="navbar-nav navbar-sidenav">
			
								<a class="nav-link navlogo text-center" href="#">
									<img src="images/deca logo.png">
								</a>
			
							<li class="nav-item" id="paypal-button-container">

							
							</li>
							<hr>
			
							<li class="nav-item">
								<a class="nav-link sidesecnd" href="#">
									<span class="textside">  Payment History</span>
								</a>
							</li>
							<li class="nav-item">
								<a class="nav-link sidesthrd" href="#">
									<span class="textside">  Transcript History</span>
								</a>
						</ul>
						
						<ul class="navbar-nav2 ml-auto">
							<li class="dropdown">
								<a href="#" id="welcome" class="dropdown-toggle" data-toggle="dropdown"><span id="user">Welcome User</span></a>
									<ul class="dropdown-menu">
											<li class="resflset"><a href="#"><i class="fa fa-fw fa-cog"></i> Edit profile</a></li>
											<li class="divider"></li>
											<li class="resflset"><button id="logOut"><i class="fa fa-fw fa-power-off"></i> Logout</button></li>
									</ul>
							</li>
						</ul>
						
					</div>
				</nav>
			
				<div class="content-wrapper">
					<div class="container-fluid">
						<div class="row">
			
						



								<div class="card-body">
										<form id="generate_transcript"   autocomplete="off">


											<div class="input-group form-group">
												<div class="input-group-prepend">
													<span class="input-group-text">Student Email &nbsp;<i class="fas fa-user"></i></span>
												</div>
												<input type="email" id="email" class="form-control" placeholder="Email" required=true />
											</div>
						
						
											<div class="input-group form-group">
												<div class="input-group-prepend">
													<span class="input-group-text">Student ID &nbsp;<i class="fas fa-user"></i></span>
												</div>
												<input type="text" id="student" class="form-control" placeholder="Student ID"   maxlength="5" size="5" readonly>
											</div>
						


											<div class="input-group form-group">
												<div class="input-group-prepend">
													<span class="input-group-text">Payment ID &nbsp;<i class="fas fa-user"></i></span>
												</div>
												<input type="text" id="orderId" class="form-control" placeholder="Payment Order ID e.g 3U069807JD249272A" required="true" readonly>
											</div>
						
						
						
						
											<div class="input-group form-group">
												<div class="input-group-prepend">
													<span class="input-group-text"><i class="fas fa-user"></i></span>
												</div>
												<select id="dept" type="select" name="Departments">
													<option value="CSC">Computer Science</option>
													<option value="ICT">Information Technology</option>
													<option value="ENG">Computer Engineering</option>
												</select>
											</div>
						
						
											
						
						
											
						
					


											<div class="form-group">
												<input type="button" id="request" value="Request For Transcript " class="btn float-right login_btn">
											</div>
										</form>
									</div>



<div class= "container">
		<h4>STEPS TO REQUEST FOR YOUR TRANSCRIPT</h4>
    <table class="rounded-list">
        <tr>
            <td>
            <ol>
            <li><p>Click the Paypal button at the top left corner of this page and complete a one-time payment of $20</p></li>
            <li><p>On success, take note of your payment Order ID</p></li>
            <li><p>Complete the Transcript Request form by filling the details required</p></li>
            <li><p>Transcript will be sent to your provided email address upon confirmation of your payment</p></li>
            </ol>
            </td>
        </tr>
    </table>
</div>



			
					</div>
				</div>
			</div>
			<script
			src="https://code.jquery.com/jquery-3.3.1.min.js"
			integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
			crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script src="js/script.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
 <script>
 	$(document).ready(function(){
	 		$("#logOut").click(function(){
	 		localStorage.removeItem("studentID");
			localStorage.removeItem("paypalPaymentName");
			localStorage.removeItem("orderID");
			localStorage.removeItem("orderTime");
	 			window.location="index.html";
	 		});
	 	});</script>


      <script>
  paypal.Buttons({
    createOrder: function(data, actions) {
      return actions.order.create({
        purchase_units: [{
          amount: {
            value: '20'
          }
        }]
      });
    },
    onApprove: function(data, actions) {
      return actions.order.capture().then(function(details) {
    let fullName=details.payer.name.given_name+" "+details.payer.name.surname;
    let currentdate = new Date(); 
let dateTime = currentdate.getDate() + "/"
                + (currentdate.getMonth()+1)  + "/" 
                + currentdate.getFullYear() + " at "  
                + currentdate.getHours() + ":"  
                + currentdate.getMinutes() + ":" 
                + currentdate.getSeconds();
        $.ajax({url:'http://localhost:3000/transaction',
          method: 'post',
          data: {"paypalPaymentName":fullName,
		  "studentID":localStorage.getItem("studentID"),
          "orderID": data.orderID,
          "orderTime":dateTime
        },
          success:function(response){
		  
			localStorage.setItem("paypalPaymentName",fullName);
			localStorage.setItem("orderID",data.orderID);
			localStorage.setItem("orderTime",dateTime);
			window.location="invoice.html";
			
			
          }

            
          
        });
      });
    }
  }).render('#paypal-button-container');

</script>

</body>
</html>